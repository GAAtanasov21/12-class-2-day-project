{% extends "base.html" %}

{% block content %}
<h2>Profile Picture Approvals</h2>

{% if pending_users %}
  <p style="margin-bottom: 2rem;">{{ pending_users|length }} profile picture(s) waiting for approval</p>

  <div style="display: grid; gap: 2rem;">
    {% for user in pending_users %}
      <div style="background: white; padding: 2rem; border: 1px solid #e1e4e8; border-radius: 6px; display: grid; grid-template-columns: 250px 1fr; gap: 2rem;">
        
        <!-- Profile Picture Preview -->
        <div>
          <div style="width: 250px; height: 250px; border-radius: 6px; overflow: hidden; border: 2px solid #e1e4e8;">
            {% if user.profile_picture %}
              <img src="/static/uploads/profiles/{{ user.profile_picture }}" alt="Profile Picture" style="width: 100%; height: 100%; object-fit: cover;">
            {% else %}
              <div style="width: 100%; height: 100%; background: #f6f8fa; display: flex; align-items: center; justify-content: center; font-size: 5rem;">
                üë§
              </div>
            {% endif %}
          </div>
        </div>

        <!-- User Info and Actions -->
        <div>
          <h3 style="margin-top: 0;">{{ user.email }}</h3>
          
          <table style="width: 100%; border: none; margin-bottom: 1.5rem;">
            <tr>
              <td style="border: none; padding: 0.5rem 0; font-weight: bold; width: 30%;">User ID:</td>
              <td style="border: none; padding: 0.5rem 0;">{{ user.id }}</td>
            </tr>
            <tr>
              <td style="border: none; padding: 0.5rem 0; font-weight: bold;">Account Type:</td>
              <td style="border: none; padding: 0.5rem 0;">
                {% if user.is_admin %}
                  <span style="color: #dc3545; font-weight: bold;">Admin</span>
                {% else %}
                  Regular User
                {% endif %}
              </td>
            </tr>
            <tr>
              <td style="border: none; padding: 0.5rem 0; font-weight: bold;">Member Since:</td>
              <td style="border: none; padding: 0.5rem 0;">{{ user.created_at.strftime('%B %d, %Y') }}</td>
            </tr>
            <tr>
              <td style="border: none; padding: 0.5rem 0; font-weight: bold;">Total Orders:</td>
              <td style="border: none; padding: 0.5rem 0;">{{ user.orders|length }}</td>
            </tr>
            <tr>
              <td style="border: none; padding: 0.5rem 0; font-weight: bold;">Reviews:</td>
              <td style="border: none; padding: 0.5rem 0;">{{ user.reviews|length }}</td>
            </tr>
          </table>

          <!-- Action Buttons -->
          <div style="display: flex; gap: 1rem;">
            <form method="post" action="{{ url_for('admin.approve_picture', user_id=user.id) }}" style="flex: 1;">
              <button type="submit" style="width: 100%; background: #28a745; border-color: #28a745;">
                ‚úÖ Approve Picture
              </button>
            </form>

            <form method="post" action="{{ url_for('admin.reject_picture', user_id=user.id) }}" style="flex: 1;">
              <button type="submit" style="width: 100%; background: #dc3545; border-color: #dc3545;" onclick="return confirm('Reject this profile picture? The file will be deleted.');">
                ‚ùå Reject Picture
              </button>
            </form>
          </div>

          <div style="margin-top: 1rem; padding: 1rem; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px;">
            <strong>Review Guidelines:</strong>
            <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem; font-size: 0.9rem;">
              <li>Picture should be appropriate and family-friendly</li>
              <li>No offensive, violent, or inappropriate content</li>
              <li>Face should be clearly visible</li>
              <li>No copyrighted material</li>
            </ul>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

{% else %}
  <div style="text-align: center; padding: 3rem; background: white; border: 1px solid #e1e4e8; border-radius: 6px;">
    <div style="font-size: 4rem; margin-bottom: 1rem;">‚úÖ</div>
    <h3>All Caught Up!</h3>
    <p style="color: #6a737d;">No pending profile pictures to review.</p>
  </div>
{% endif %}

<div style="margin-top: 2rem;">
  <a href="{{ url_for('admin.dashboard') }}" class="button ghost">‚Üê Back to Dashboard</a>
</div>

{% endblock %}